{"version":3,"sources":["./src/app/auth/login/login-routing.module.ts","./src/app/auth/login/login.page.html","./src/app/auth/login/login.module.ts","./src/app/auth/login/login.page.ts","./src/app/auth/login/login.page.scss"],"names":[],"mappings":"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","file":"auth-login-login-module-es2015.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { LoginPage } from './login.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LoginPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class LoginPageRoutingModule {}\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"end\\\">\\n      <app-loading-toolbar-button></app-loading-toolbar-button>\\n    </ion-buttons>\\n    <ion-title>ورود</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content class=\\\"ion-padding\\\">\\n  <form\\n    [formGroup]=\\\"loginForm\\\"\\n    class=\\\"login-form action-container\\\"\\n    (ngSubmit)=\\\"login(loginForm)\\\"\\n    method=\\\"post\\\"\\n  >\\n    <div class=\\\"action-content\\\">\\n      <div class=\\\"row justify-content-center\\\">\\n        <div class=\\\"col-12\\\">\\n          <ion-item>\\n            <ion-input\\n              formControlName=\\\"phone\\\"\\n              placeholder=\\\"شماره موبایل ۰۹XXXXXXXX\\\"\\n              type=\\\"phone\\\"\\n            ></ion-input>\\n          </ion-item>\\n        </div>\\n      </div>\\n      <div class=\\\"row justify-content-center\\\">\\n        <div class=\\\"col-12\\\">\\n          <ion-item>\\n            <ion-input\\n              formControlName=\\\"password\\\"\\n              placeholder=\\\"گذرواژه\\\"\\n              type=\\\"password\\\"\\n              name=\\\"password\\\"\\n            ></ion-input>\\n          </ion-item>\\n        </div>\\n      </div>\\n      <span (click)=\\\"forgotPassword()\\\" class=\\\"light-text small-text d-block text-left pl-2 mt-3\\\">گذرواژه ام را فراموش کرده ام.</span>\\n      <!-- <div class=\\\"row mt-3 justify-content-start\\\">\\n        <div class=\\\"col-6 d-flex align-items-center justify-content-right\\\">\\n          <ion-checkbox\\n            formControlName=\\\"isProvider\\\"\\n            class=\\\"primary-checkbox\\\"\\n          ></ion-checkbox>\\n          <span class=\\\"light-text small-text mr-2\\\">به عنوان مشاور</span>\\n        </div>\\n      </div> -->\\n    </div>\\n    <div class=\\\"actions\\\">\\n\\t\\t<div class=\\\"actions-wrapper dual\\\">\\n\\t\\t\\t\\n      <app-submit-button [isWaiting]=\\\"submitDisabled\\\" text=\\\"وارد شوید\\\" ></app-submit-button>\\n      <span class=\\\"small-text light-text align-self-center mt-3 mb-1\\\">هنوز حساب کاربری ندارید؟</span>\\n\\t\\t  <ion-button\\n            \\n            routerLink=\\\"/register\\\"\\n            class=\\\"secondary-button\\\"\\n            routerDirection=\\\"forward\\\"\\n            >ثبت نام کنید</ion-button\\n          >\\n\\t\\t</div>\\n    </div>\\t\\n      \\n    \\n  </form>\\n</ion-content>\\n\";","import { CommonDeclarationsModule } from './../../common/common-declarations/common-declarations.module';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LoginPageRoutingModule } from './login-routing.module';\n\nimport { LoginPage } from './login.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    LoginPageRoutingModule,\n    ReactiveFormsModule,\n    CommonDeclarationsModule\n  ],\n  declarations: [LoginPage]\n})\nexport class LoginPageModule {}\n","import { FormHelperService } from './../../services/form-helper.service';\nimport { catchError, tap, map } from \"rxjs/operators\";\nimport { EnvService } from \"./../../services/env.service\";\nimport { FormControl, Validators, ValidationErrors } from \"@angular/forms\";\nimport { FormGroup, AbstractControl } from \"@angular/forms\";\nimport { Component, OnInit } from \"@angular/core\";\nimport { MenuController, NavController } from \"@ionic/angular\";\nimport { AuthService } from \"src/app/services/auth.service\";\nimport { AlertService } from \"src/app/services/alert.service\";\nimport { of } from \"rxjs\";\nimport { FormValidationMessageField,FormValidationType } from \"src/app/models/from-validation-message\";\n\n@Component({\n  selector: \"app-login\",\n  templateUrl: \"./login.page.html\",\n  styleUrls: [\"./login.page.scss\"],\n})\nexport class LoginPage implements OnInit {\n  loginForm = new FormGroup({\n    phone: new FormControl(\"\", Validators.compose([\n      Validators.required,\n      Validators.pattern(\"(09\\\\d{9})\")//|admin\")\n    ])),\n    password: new FormControl('', Validators.required),\n    isProvider: new FormControl(false),\n  });\n  validationMessages: FormValidationMessageField[] = [];\n  \n  submitDisabled = false;\n  constructor(\n    private authService: AuthService,\n    private navCtrl: NavController,\n    private alertService: AlertService,\n    private menu: MenuController,\n    private env: EnvService,\n    private formHelper:FormHelperService\n  ) {\n    this.formHelper.addValidationMessage(this.validationMessages,'phone',FormValidationType.REQUIRED,\n    \"شماره موبایل الزامی است.\");\n    this.formHelper.addValidationMessage(this.validationMessages,'phone',FormValidationType.PATTERN,\n    \"فرمت شماره موبایل صحیح نیست.\");\n    this.formHelper.addValidationMessage(this.validationMessages,'password',FormValidationType.REQUIRED,\n    \"گذرواژه الزامی است.\");\n  }\n\n  ionViewWillEnter() {\n    this.menu.enable(false);\n  }\n  ionViewWillLeave() {\n    this.menu.enable(true);\n  }\n  ngOnInit() {}\n  login(form: FormGroup) {\n    console.log(\"login\");\n    if(!this.formHelper.validateForm(this.validationMessages,form))\n    {\n      return;\n    }\n    let roleId = form.value.isProvider\n      ? this.env.PROVIDER_ROLE_ID\n      : this.env.USER_ROLE_ID;\n    this.env.somethingIsPending(\"logging in\");\n    this.submitDisabled = true;\n    this.authService\n      .login(form.value.phone, form.value.password, roleId)\n      .pipe(\n        catchError((error) => {\n          const errorType = error[\"error\"][\"error\"];\n          switch (errorType) {\n            case \"invalid_credentials\":\n              this.alertService.presentError(\n                \"شماره موبایل یا گذرواژه صحیح نیست.\"\n              );\n              break;\n            case \"not_verified\":\n              this.alertService.presentError(\n                \"شماره موبایل اعتبار سنجی نشده است.\"\n              );\n              return this.authService\n                .requestVerificationCode(form.value.phone, form.value.password)\n                .pipe(\n                  tap((result) => {\n                    this.authService.tempPassword = form.value.password;\n                    this.authService.tempPhoneNumber = form.value.phone;\n                  }),\n                  catchError((err) => {\n                    this.alertService.presentError(\n                      \"ارسال پیام اعتبار سنجی با مشکل روبه رو شد.\"\n                    );\n                    return of(false);\n                  }),\n                  map((result) => {\n                    if (result != false) {\n                      this.alertService.presentSuccess(\n                        \"کد اعتبارسنجی به شماره همراه شما راسال شد.\"\n                      );\n                      this.navCtrl.navigateForward(\"/verify\");\n                    }\n                    return false;\n                  })\n                );\n              break;\n            default:\n              this.alertService.presentError(\n                \"ورود به حساب با مشکل روبرو شده است.\"\n              );\n          }\n\n          return of(false);\n        })\n      )\n      .subscribe(\n        (data) => {\n          this.submitDisabled = false;\n          this.env.somethingIsDonePending(\"logging in\");\n          if (data != false) {\n            this.alertService.presentSuccess(\"خوش آمدید!\");\n            if (roleId == this.env.PROVIDER_ROLE_ID) {\n              this.navCtrl.navigateRoot([\"/\"]);\n            } else {\n              this.navCtrl.navigateRoot(\"/\");\n            }\n            this.authService.role = roleId;\n          }\n        },\n        (error) => {\n          this.submitDisabled = false;\n          this.env.somethingIsDonePending(\"logging in\");\n        }\n      );\n  }\n  forgotPassword()\n  {\n    this.navCtrl.navigateForward(['/forgot-password-phone'])\n  }\n}\n","export default \".login-form {\\n  height: 100%;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: space-between;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvYXV0aC9sb2dpbi9sb2dpbi5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFSSxZQUFBO0VBQ0EsYUFBQTtFQUNBLHNCQUFBO0VBQ0EsOEJBQUE7QUFBSiIsImZpbGUiOiJzcmMvYXBwL2F1dGgvbG9naW4vbG9naW4ucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmxvZ2luLWZvcm1cbntcbiAgICBoZWlnaHQ6IDEwMCU7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcbn0iXX0= */\";"],"sourceRoot":"webpack:///"}