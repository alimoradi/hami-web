{"version":3,"sources":["webpack:///src/app/auth/login/login-routing.module.ts","webpack:///src/app/auth/login/login.page.html","webpack:///src/app/auth/login/login.module.ts","webpack:///src/app/auth/login/login.page.ts","webpack:///src/app/auth/login/login.page.scss"],"names":["routes","path","component","LoginPageRoutingModule","imports","forChild","exports","LoginPageModule","declarations","LoginPage","authService","navCtrl","alertService","menu","env","formHelper","loginForm","phone","compose","required","pattern","password","isProvider","validationMessages","submitDisabled","addValidationMessage","REQUIRED","PATTERN","enable","form","console","log","validateForm","roleId","value","PROVIDER_ROLE_ID","USER_ROLE_ID","somethingIsPending","login","pipe","error","errorType","presentError","requestVerificationCode","result","tempPassword","tempPhoneNumber","err","presentSuccess","navigateForward","subscribe","data","somethingIsDonePending","navigateRoot","role","selector","template"],"mappings":"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","file":"auth-login-login-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { LoginPage } from './login.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LoginPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class LoginPageRoutingModule {}\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"end\\\">\\n      <app-loading-toolbar-button></app-loading-toolbar-button>\\n    </ion-buttons>\\n    <ion-title>ورود</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content class=\\\"ion-padding\\\">\\n  <form\\n    [formGroup]=\\\"loginForm\\\"\\n    class=\\\"login-form action-container\\\"\\n    (ngSubmit)=\\\"login(loginForm)\\\"\\n    method=\\\"post\\\"\\n  >\\n    <div class=\\\"action-content\\\">\\n      <div class=\\\"row justify-content-center\\\">\\n        <div class=\\\"col-12\\\">\\n          <ion-item>\\n            <ion-input\\n              formControlName=\\\"phone\\\"\\n              placeholder=\\\"شماره موبایل ۰۹XXXXXXXX\\\"\\n              type=\\\"phone\\\"\\n            ></ion-input>\\n          </ion-item>\\n        </div>\\n      </div>\\n      <div class=\\\"row justify-content-center\\\">\\n        <div class=\\\"col-12\\\">\\n          <ion-item>\\n            <ion-input\\n              formControlName=\\\"password\\\"\\n              placeholder=\\\"گذرواژه\\\"\\n              type=\\\"password\\\"\\n              name=\\\"password\\\"\\n            ></ion-input>\\n          </ion-item>\\n        </div>\\n      </div>\\n      <span (click)=\\\"forgotPassword()\\\" class=\\\"light-text small-text d-block text-left pl-2 mt-3\\\">گذرواژه ام را فراموش کرده ام.</span>\\n      <!-- <div class=\\\"row mt-3 justify-content-start\\\">\\n        <div class=\\\"col-6 d-flex align-items-center justify-content-right\\\">\\n          <ion-checkbox\\n            formControlName=\\\"isProvider\\\"\\n            class=\\\"primary-checkbox\\\"\\n          ></ion-checkbox>\\n          <span class=\\\"light-text small-text mr-2\\\">به عنوان مشاور</span>\\n        </div>\\n      </div> -->\\n    </div>\\n    <div class=\\\"actions\\\">\\n\\t\\t<div class=\\\"actions-wrapper dual\\\">\\n\\t\\t\\t\\n      <app-submit-button [isWaiting]=\\\"submitDisabled\\\" text=\\\"وارد شوید\\\" ></app-submit-button>\\n      <span class=\\\"small-text light-text align-self-center mt-3 mb-1\\\">هنوز حساب کاربری ندارید؟</span>\\n\\t\\t  <ion-button\\n            \\n            routerLink=\\\"/register\\\"\\n            class=\\\"secondary-button\\\"\\n            routerDirection=\\\"forward\\\"\\n            >ثبت نام کنید</ion-button\\n          >\\n\\t\\t</div>\\n    </div>\\t\\n      \\n    \\n  </form>\\n</ion-content>\\n\";","import { CommonDeclarationsModule } from './../../common/common-declarations/common-declarations.module';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LoginPageRoutingModule } from './login-routing.module';\n\nimport { LoginPage } from './login.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    LoginPageRoutingModule,\n    ReactiveFormsModule,\n    CommonDeclarationsModule\n  ],\n  declarations: [LoginPage]\n})\nexport class LoginPageModule {}\n","import { FormHelperService } from './../../services/form-helper.service';\nimport { catchError, tap, map } from \"rxjs/operators\";\nimport { EnvService } from \"./../../services/env.service\";\nimport { FormControl, Validators, ValidationErrors } from \"@angular/forms\";\nimport { FormGroup, AbstractControl } from \"@angular/forms\";\nimport { Component, OnInit } from \"@angular/core\";\nimport { MenuController, NavController } from \"@ionic/angular\";\nimport { AuthService } from \"src/app/services/auth.service\";\nimport { AlertService } from \"src/app/services/alert.service\";\nimport { of } from \"rxjs\";\nimport { FormValidationMessageField,FormValidationType } from \"src/app/models/from-validation-message\";\n\n@Component({\n  selector: \"app-login\",\n  templateUrl: \"./login.page.html\",\n  styleUrls: [\"./login.page.scss\"],\n})\nexport class LoginPage implements OnInit {\n  loginForm = new FormGroup({\n    phone: new FormControl(\"\", Validators.compose([\n      Validators.required,\n      Validators.pattern(\"(09\\\\d{9})\")//|admin\")\n    ])),\n    password: new FormControl('', Validators.required),\n    isProvider: new FormControl(false),\n  });\n  validationMessages: FormValidationMessageField[] = [];\n  \n  submitDisabled = false;\n  constructor(\n    private authService: AuthService,\n    private navCtrl: NavController,\n    private alertService: AlertService,\n    private menu: MenuController,\n    private env: EnvService,\n    private formHelper:FormHelperService\n  ) {\n    this.formHelper.addValidationMessage(this.validationMessages,'phone',FormValidationType.REQUIRED,\n    \"شماره موبایل الزامی است.\");\n    this.formHelper.addValidationMessage(this.validationMessages,'phone',FormValidationType.PATTERN,\n    \"فرمت شماره موبایل صحیح نیست.\");\n    this.formHelper.addValidationMessage(this.validationMessages,'password',FormValidationType.REQUIRED,\n    \"گذرواژه الزامی است.\");\n  }\n\n  ionViewWillEnter() {\n    this.menu.enable(false);\n  }\n  ionViewWillLeave() {\n    this.menu.enable(true);\n  }\n  ngOnInit() {}\n  login(form: FormGroup) {\n    console.log(\"login\");\n    if(!this.formHelper.validateForm(this.validationMessages,form))\n    {\n      return;\n    }\n    let roleId = form.value.isProvider\n      ? this.env.PROVIDER_ROLE_ID\n      : this.env.USER_ROLE_ID;\n    this.env.somethingIsPending(\"logging in\");\n    this.submitDisabled = true;\n    this.authService\n      .login(form.value.phone, form.value.password, roleId)\n      .pipe(\n        catchError((error) => {\n          const errorType = error[\"error\"][\"error\"];\n          switch (errorType) {\n            case \"invalid_credentials\":\n              this.alertService.presentError(\n                \"شماره موبایل یا گذرواژه صحیح نیست.\"\n              );\n              break;\n            case \"not_verified\":\n              this.alertService.presentError(\n                \"شماره موبایل اعتبار سنجی نشده است.\"\n              );\n              return this.authService\n                .requestVerificationCode(form.value.phone, form.value.password)\n                .pipe(\n                  tap((result) => {\n                    this.authService.tempPassword = form.value.password;\n                    this.authService.tempPhoneNumber = form.value.phone;\n                  }),\n                  catchError((err) => {\n                    this.alertService.presentError(\n                      \"ارسال پیام اعتبار سنجی با مشکل روبه رو شد.\"\n                    );\n                    return of(false);\n                  }),\n                  map((result) => {\n                    if (result != false) {\n                      this.alertService.presentSuccess(\n                        \"کد اعتبارسنجی به شماره همراه شما راسال شد.\"\n                      );\n                      this.navCtrl.navigateForward(\"/verify\");\n                    }\n                    return false;\n                  })\n                );\n              break;\n            default:\n              this.alertService.presentError(\n                \"ورود به حساب با مشکل روبرو شده است.\"\n              );\n          }\n\n          return of(false);\n        })\n      )\n      .subscribe(\n        (data) => {\n          this.submitDisabled = false;\n          this.env.somethingIsDonePending(\"logging in\");\n          if (data != false) {\n            this.alertService.presentSuccess(\"خوش آمدید!\");\n            if (roleId == this.env.PROVIDER_ROLE_ID) {\n              this.navCtrl.navigateRoot([\"/\"]);\n            } else {\n              this.navCtrl.navigateRoot(\"/\");\n            }\n            this.authService.role = roleId;\n          }\n        },\n        (error) => {\n          this.submitDisabled = false;\n          this.env.somethingIsDonePending(\"logging in\");\n        }\n      );\n  }\n  forgotPassword()\n  {\n    this.navCtrl.navigateForward(['/forgot-password-phone'])\n  }\n}\n","export default \".login-form {\\n  height: 100%;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: space-between;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvYXV0aC9sb2dpbi9sb2dpbi5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFSSxZQUFBO0VBQ0EsYUFBQTtFQUNBLHNCQUFBO0VBQ0EsOEJBQUE7QUFBSiIsImZpbGUiOiJzcmMvYXBwL2F1dGgvbG9naW4vbG9naW4ucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmxvZ2luLWZvcm1cbntcbiAgICBoZWlnaHQ6IDEwMCU7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcbn0iXX0= */\";"]}